/* Modified: October 9, 2014, 10:42:58 */
!function(){function a(a){q.publish({channel:p,message:a})}function b(a,b){h.strokeStyle=a,h.beginPath(),h.moveTo(b[0].x,b[0].y);for(var c=1;c<b.length;c++)h.lineTo(b[c].x,b[c].y);h.stroke()}function c(a){!a||a.plots.length<1||b(a.color,a.plots)}function d(a){if(a.preventDefault(),r){var c=j?a.targetTouches[0].pageX-g.offsetLeft:a.offsetX||a.layerX-g.offsetLeft,d=j?a.targetTouches[0].pageY-g.offsetTop:a.offsetY||a.layerY-g.offsetTop;s.push({x:c<<0,y:d<<0}),b(i,s)}}function e(a){a.preventDefault(),r=!0}function f(b){b.preventDefault(),r=!1,a({color:i,plots:s}),s=[]}var g=document.getElementById("drawCanvas"),h=g.getContext("2d"),i=document.querySelector(":checked").getAttribute("data-color");g.width=Math.min(document.documentElement.clientWidth,window.innerWidth||300),g.height=Math.min(document.documentElement.clientHeight,window.innerHeight||300),h.strokeStyle=i,h.lineWidth="3",h.lineCap=h.lineJoin="round",document.getElementById("colorSwatch").addEventListener("click",function(){i=document.querySelector(":checked").getAttribute("data-color")},!1);var j="ontouchstart"in window,k=navigator.pointerEnabled,l=navigator.msPointerEnabled,m=j?"touchstart":k?"pointerdown":l?"MSPointerDown":"mousedown",n=j?"touchmove":k?"pointermove":l?"MSPointerMove":"mousemove",o=j?"touchend":k?"pointerup":l?"MSPointerUp":"mouseup";g.addEventListener(m,e,!1),g.addEventListener(n,d,!1),g.addEventListener(o,f,!1);var p="draw",q=PUBNUB.init({publish_key:"pub-c-156a6d5f-22bd-4a13-848d-b5b4d4b36695",subscribe_key:"sub-c-f762fb78-2724-11e4-a4df-02ee2ddab7fe",leave_on_unload:!0});q.subscribe({channel:p,callback:c,presence:function(a){a.occupancy>1&&(document.getElementById("unit").textContent="doodlers"),document.getElementById("occupancy").textContent=a.occupancy;var b=document.getElementById("occupancy").parentNode;b.classList.add("anim"),b.addEventListener("transitionend",function(){b.classList.remove("anim")},!1)}}),drawHistory&&q.history({channel:p,count:50,callback:function(a){q.each(a[0],c)}});var r=!1,s=[]}();